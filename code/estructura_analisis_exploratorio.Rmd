---
title: "Untitled"
author: "Nahaly_Cardenas"
date: "16 de marzo de 2017"
output: html_document
---
## Problemática



## Hipótesis inicial
Se plantea como hipótesis la  demanda publicada en New York Liberty Civils <https://www.nyclu.org/en/stop-and-frisk-data> , es decir verificar si la ley Stop-Frisk está siendo aplicada bajo conceptos de discriminación.  El análisis inicial se fundamentó en el tiempo de observación, sin embargo se desechó la posibilidad, dado que no se tiene registro de personas observadas que no fueron paradas.


## Pregunta 1
Cuáles son los factores que determinan el tiempo de parada `perstop`, interesa verificar si está influenciado por características discriminatorias.

```{r, message=FALSE}
# Carga de librerías
library(dplyr)
library(ggplot2)
library(PASWR2)
library("dataQualityR")
```

```{r}
# Carga del Dataset
# SQFdata <- read.csv("2014.csv")
# buscar attach???? o similar
```

# 0. SELECCION DE VARIABLES:
```{r}
SQFdata <- select(SQFdata,
                  build,
                  frisked,
                  knifcuti, machgun, othrweap,
                  pf_ptwep, pf_baton,
                  cs_lkout, cs_cloth,
                  rf_attir, rf_vcact, 
                  sb_outln, sb_admis,
                  ac_time, ac_stsnd,
                  forceuse,
                  crossst,
                  xcoord, ycoord,
                  explnstp,
                  perstop, arstmade,
                  sex)
```

# 1. ANÁLISIS DESCRIPTIVO
```{r}
drq.num <- paste("./dqr_num.csv", sep = "")
drq.cat <- paste("./dqr_cat.csv", sep = "")
checkDataQuality(SQFdata, out.file.num = drq.num,  out.file.cat = drq.cat)
DQR.num <- read.csv("dqr_num.csv")
DQR.cat <- read.csv("dqr_cat.csv")
```

## 1.A Variables numéricas
```{r, results=markup}
print(DQR.num)
```

## 1.B Variables categóricas
```{r}
print(DQR.cat)
```

# 2. ANÁLISIS EXPLORATORIO VARIABLES

## VARIABLE DEPENDIENTE

## Tiempo de parada (perstop) 
```{r, fig.height=5, fig.width=15}
hist(SQFdata$perstop, breaks = 87,  prob=T, xlim=c(0,87))
plotdist(SQFdata$perstop , histo = TRUE, demp = TRUE)
```
## VARIABLES INDEPENDIENTES

## Complexión del sospechoso (build)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade,build) %>%
        summarise(n=n(), 
                  timeStop= sum(perstop),
                  timeStop_mean=round(mean(perstop),2))%>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(build,arstmade) %>%
        summarise(n=n(),
                  timeStop_mean= round(mean(perstop),2))%>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(build)) + geom_bar() + ylab("Frequency")
p2 = ggplot(data = SQFdata, aes(build,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(build)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Percentage")
multiplot(p1,p2,p3,cols=2)
```
