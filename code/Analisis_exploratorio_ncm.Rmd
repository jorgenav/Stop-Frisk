---
title: "Untitled"
author: "Nahaly_Cardenas"
date: "16 de marzo de 2017"
output: html_document
---
## Problem?tica



## Hip?teis inicial
Se plantea como hip?tesis la  demanda publicada en New York Liberty Civils <https://www.nyclu.org/en/stop-and-frisk-data> , es decir verificar si la ley Stop-Frisk est? siendo aplicada bajo conceptos de discriminaci?n.  El an?lisis inicial se fundament? en el tiempo de observaci?n, sin embargo se desech? la posibilidad, dado que no se tiene registro de personas observadas que no fueron paradas.


## Pregunta 1
Cu?les son los factores que determinan el tiempo de parada `perstop`, interesa verificar si est? influenciado por caracter?sticas discriminatorias.

```{r, message=FALSE}
# Carga de librer?as
library(dplyr)
library(ggplot2)
library(PASWR2)
library("dataQualityR")
library(mixtools)
library(fitdistrplus)
```

```{r}
# Carga del Dataset
#SQFdata <- read.csv("2014.csv")
# buscar attach???? o similar
if(!exists("foo", mode="function")) source("Cleaning_Data.R")
```

# 0. SELECCION DE VARIABLES (para este informe):
```{r}
SQFdata <- dplyr::select(SQFdata,
                  perstop,
                  perobs,
                  arstmade,
                  pct,
                  ser_num,
                  city,
                  searched,
                  pistol,
                  pf_hcuff,
                  pf_pepsp,
                  cs_drgtr,
                  cs_furtv,
                  cs_vcrim,
                  rf_rfcmp,
                  rf_verbl,
                  sb_other,
                  ac_proxm,
                  ac_rept,
                  inout,
                  trhsloc,
                  addrpct,
                  repcmd,
                  revcmd
                  )
```

```{r}
str(SQFdata)
```

# 1. DATA QUALITY REPORT
```{r}
drq.num <- paste("./dqr_num.csv", sep = "")
drq.cat <- paste("./dqr_cat.csv", sep = "")
checkDataQuality(SQFdata, out.file.num = drq.num,  out.file.cat = drq.cat)
DQR.num <- read.csv("dqr_num.csv")
DQR.cat <- read.csv("dqr_cat.csv")
```

## 1.A Variables num?ricas
```{r, results=markup}
print(DQR.num)
```

## 1.B Variables categ?ricas
```{r}
print(DQR.cat)
```

# 2. AN?LISIS EXPLORATORIO VARIABLES

## VARIABLE DEPENDIENTE
## Tiempo de parada (perstop)
```{r, fig.height=5, fig.width=15}
#hist(SQFdata$perstop, breaks = 20,  prob=F, xlim=c(0,87))
plotdist(SQFdata$perstop , histo = TRUE, demp = TRUE)

stop <- SQFdata$perstop
mixmdl <- normalmixEM(stop, k=2)
plot(mixmdl,which=2)
lines(density(stop), lty=2, lwd=2)
```
## VARIABLES INDEPENDIENTES

## Tiempo de observaci?n (perobs)
```{r, fig.height=5, fig.width=15}
SQFdata %>% filter(perobs<150) %>%
        ggplot(aes(perobs, perstop)) +
        geom_point() +
        labs(x="Per?odo de observaci?n ", y="Per?odo de parada") +
        geom_smooth(method = 'lm') +
        scale_size_area() +
        ggtitle("Relaci?n entre tiempo de observaci?n y parada")
```

```{r, fig.height=5, fig.width=15}
cor(obs, stop)
```

```{r, fig.height=5, fig.width=15}
SQFdata %>% 
        group_by(arstmade) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2),
                  perObs= sum(perobs),
                  perObs_media= round(mean(perobs),2),
                  perObs_mediana= round(median(perobs),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```


```{r, fig.height=5, fig.width=15}
SQFdata %>% filter(perobs<150)%>% 
        ggplot(aes(arstmade, log(perobs))) +
        geom_boxplot()
        ggtitle("Relaci?n entre tiempo de observaci?n y parada")
```

## Condados (city)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, city) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(city)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(city,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(city)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
## Buscado (searched)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, searched) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(searched)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(searched,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(searched)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Pistola (pistol)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, pistol) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(pistol)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(pistol,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(pistol)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
## El oficial usa fuerza f?scica - esposas (pf_hcuff)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, pf_hcuff) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(pf_hcuff)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(pf_hcuff,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(pf_hcuff)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
## El oficial usa fuerza f?sica - spray pimienta (pf_pepsp)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, pf_pepsp) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(pf_pepsp)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(pf_pepsp,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(pf_pepsp)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
## Raz?n para la parada - acciones indicaban transacci?n de drogas (cs_drgtr)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, cs_drgtr) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(cs_drgtr)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(cs_drgtr,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(cs_drgtr)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Raz?n para la parada - movimientos sospechosos (cs_furtv)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, cs_furtv) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(cs_furtv)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(cs_furtv,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(cs_furtv)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Raz?n para la parada - acciones que indican estar involucrado en un crimen violento (cs_vcrim)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, cs_vcrim) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(cs_vcrim)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(cs_vcrim,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(cs_vcrim)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Raz?n para la parada - rehusarse a cumplir con las instrucciones del oficial (rf_rfcmp)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, rf_rfcmp) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(rf_rfcmp)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(rf_rfcmp,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(rf_rfcmp)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Raz?n para la parada - amenazas verbales por parte del sospechoso (rf_verbl)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, rf_verbl) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(rf_verbl)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(rf_verbl,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(rf_verbl)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Raz?n de busqueda - otros (sb_other)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, sb_other) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(sb_other)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(sb_other,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(sb_other)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Circunstancias adicionales - proximidad a la escena del delito (ac_proxm)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, ac_proxm) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(ac_proxm)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(ac_proxm,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(ac_proxm)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Circunstancias adicionales - informe de la v?ctima / testigo / oficial (ac_rept)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, ac_rept) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(ac_rept)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(ac_rept,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(ac_rept)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Fue parado dentro o fuera (inout)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, inout) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(inout)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(inout,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(inout)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Fue ubicado en la vivienda o por la autoridad  (trhsloc)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, trhsloc) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(trhsloc)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(trhsloc,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(trhsloc)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Recinto donde se realiz? la parada (pct)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, pct) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(pct)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(pct,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(pct)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Direcci?n del recinto donde se realiz? la parada (addrpct)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, addrpct) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(addrpct)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(addrpct,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(addrpct)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Comando del oficial que hace el informe  (repcmd)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, repcmd) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(repcmd)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(repcmd,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(repcmd)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

## Comando del oficial que revisa  (revcmd)
```{r, fig.height=5, fig.width=15}
SQFdata %>% group_by(arstmade, revcmd) %>%
        summarise(n=n(), 
                  perStop= sum(perstop),
                  perStop_media= round(mean(perstop),2),
                  perStop_mediana= round(median(perstop),2)) %>%
        mutate(freq_n=paste0(round( n/sum(n)*100,2),"%"))

```

```{r, fig.height=5, fig.width=15}
p1 = ggplot(data = SQFdata, aes(revcmd)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(revcmd,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(revcmd)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```

# sex
```{r Hugo}
SQFdata %>% group_by(sex) %>%
    summarise(count=n()) %>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(sex)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(sex,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(sex)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$sex[which(is.na(SQFdata$sex))]
```
# weight
# Weight in pounds
```{r}
SQFdata %>% group_by(weight) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(weight)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(weight,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(weight)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$weight[which(is.na(SQFdata$weight))]
```
# haircolr
```{r}

SQFdata %>% group_by(haircolr) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(haircolr)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(haircolr,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(haircolr)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$haircolr[which(is.na(SQFdata$haircolr))]
```
# riflshot
# 10860 NAs
```{r}
SQFdata %>% group_by(riflshot) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(riflshot)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(riflshot,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(riflshot)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# sumissue
# Was summons issued?
```{r}
SQFdata %>% group_by(sumissue) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(sumissue)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(sumissue,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(sumissue)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$sumissue[which(is.na(SQFdata$sumissue))]
```
# pf_hands
# 9133 NAs
```{r}
SQFdata %>% group_by(pf_hands) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(pf_hands)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(pf_hands,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(pf_hands)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# pf_wall
# 10412 NAs
```{r}
SQFdata %>% group_by(pf_wall) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(pf_wall)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(pf_wall,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(pf_wall)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# pf_other
# 10813 NAs
```{r}
SQFdata %>% group_by(pf_other) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(pf_other)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(pf_other,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(pf_other)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# cs_objcs
# 10445 NAs
```{r}
SQFdata %>% group_by(cs_objcs) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(cs_objcs)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(cs_objcs,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(cs_objcs)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# cs_bulge
# 10032 NAs
```{r}
SQFdata %>% group_by(cs_bulge) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(cs_bulge)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(cs_bulge,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(cs_bulge)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# rf_vcrim
# 8325 NAs
```{r}
SQFdata %>% group_by(rf_vcrim) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(rf_vcrim)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(rf_vcrim,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(rf_vcrim)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# rf_knowl
# 10244 NAs
```{r}
SQFdata %>% group_by(rf_knowl) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(rf_knowl)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(rf_knowl,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(rf_knowl)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# rf_furt
# 6880 NAs
```{r}
SQFdata %>% group_by(rf_furt) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(rf_furt)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(rf_furt,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(rf_furt)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# ac_evasv
# 8553 NAs
```{r}
SQFdata %>% group_by(ac_evasv) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(ac_evasv)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(ac_evasv,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(ac_evasv)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# ac_assoc
# 9972 NAs
```{r}
SQFdata %>% group_by(ac_assoc) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(ac_assoc)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(ac_assoc,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(ac_assoc)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# ac_inves
# 9355 NAs
```{r}
SQFdata %>% group_by(ac_inves) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(ac_inves)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(ac_inves,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(ac_inves)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)
```
# stname
# String -> location of stop street name -> Es interesante?
```{r}
SQFdata %>% group_by(stname) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(stname)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(stname,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(stname)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$stname[which(is.na(SQFdata$stname))]
```
# offunif
```{r}
SQFdata %>% group_by(offunif) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(offunif)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(offunif,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(offunif)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$offunif[which(is.na(SQFdata$offunif))]
```
# offverb
# verbal statement provided by officer (if not in uniform) -> Limpiar datos
```{r}
SQFdata %>% group_by(offverb) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(offverb)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(offverb,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(offverb)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$offverb[which(is.na(SQFdata$offverb))]
```
# officrid
# id card provided by officer (if not in uniform) -> Limpiar datos
```{r}
SQFdata %>% group_by(officrid) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(officrid)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(officrid,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(officrid)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$officrid[which(is.na(SQFdata$officrid))]
```
# offshld
# shield provided by officer (if not in uniform) -> Limpiar datos
```{r}
SQFdata %>% group_by(offshld) %>%
    summarise(count=n())%>%
    arrange(desc(count))

p1 = ggplot(data = SQFdata, aes(offshld)) + geom_bar() + ylab("Frecuencia")
p2 = ggplot(data = SQFdata, aes(offshld,perstop)) + geom_boxplot()
p3 = ggplot(data = SQFdata, aes(offshld)) + geom_bar(aes(fill = arstmade), position = "fill") + ylab("Porcentaje")
multiplot(p1,p2,p3,cols=2)

SQFdata$offshld[which(is.na(SQFdata$offshld))]

```

# An?lisis variables independientes







